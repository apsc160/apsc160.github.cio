<div id="tabs" class="enhanceable_content tabs">
  <ul>
    <li id="tabHeader_1"><a style="text-decoration: none;" href="#tabpage_1">Installation</a></li>
    <li id="tabHeader_2"><a style="text-decoration: none;" href="#tabpage_2">Your First Project</a></li>
  </ul>
  <div class="tabpage" id="tabpage_1">
    <p>
      With this set of instructions, we will install the <span class="highlight" style="color: crimson; font-weight: bold;">DAQlib</span> Library and simulator on Windows systems for use with Visual Studio 2017. 
      For other platforms, such as MacOS, go to the appropriate installation page.
    </p>

    For the instructions below, you will need to download the following zip file:
    <ul>
      <li><a href="https://apsc160.github.io/daqinstall/assets/DAQlib_windows.zip">DAQlib_windows.zip</a></li>
    </ul>

    <h3>Installation for a Single User:</h3> 
    
    To install the DAQlib library and simulator for Visual Studio on your local computer, we will first
    <span class="highlight" style="color: crimson; font-weight: bold;">download a zip file</span> containing all the required headers, libraries, and 
    binaries, and then run an <span class="highlight" style="color: crimson; font-weight: bold;">installation script</span> that will create a new project 
    template to access these files.
    <ol>
      <li>Download the DAQlib zip file for your system above.  This should create a zip file called <span class="file" style="color: blue; font-weight: bold; font-family: courier;">DAQlib_windows.zip</span> in your
        downloads folder.
      </li>
      <li>Unzip the file by right-clicking on <span class="file" style="color: blue; font-weight: bold; font-family: courier;">DAQlib_windows.zip</span> and selecting <b>Extract all...</b>
        <br/> Leave the checkbox <b>Show extracted files when complete</b> checked.
        
        <img alt="zip extraction" class="figure" style="margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" src="https://apsc160.github.io/daqinstall/images/windows/extract.png" /> 
        
        Inside the unzipped folder, you should see a new subfolder named <span class="file" style="color: blue; font-weight: bold; font-family: courier;">DAQlib</span>, as well as 
        two script files: <span class="file" style="color: blue; font-weight: bold; font-family: courier;">install.bat</span> and <span class="file" style="color: blue; font-weight: bold; font-family: courier;">uninstall.bat</span>.

        <img class="figure" style="margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="unzipped contents" src="https://apsc160.github.io/daqinstall/images/windows/daqunzipped.png" />
      </li>
      <li>
        Double-click on <span class="file" style="color: blue; font-weight: bold; font-family: courier;">install.bat</span>
        <br/> 
        If you get a security warning about opening a file with an unverified publisher, select <b>Run</b>.
        <img class="figure" style="margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="Windows security message" src="https://apsc160.github.io/daqinstall/images/windows/security_highlight.png" /> In Windows 10, if you get a SmartScreen warning message saying that it has prevented you from running the application, first click
        on <b>More info</b> and then <b>Run anyway</b>
        <img class="figure" style="margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="windows smartscreen info" src="https://apsc160.github.io/daqinstall/images/windows/smartscreen1_highlight.png" />
        <img class="figure" style="margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="windows smartscreen run" src="https://apsc160.github.io/daqinstall/images/windows/smartscreen2_highlight.png" />
      </li>
      <li>
        The installation script will ask you to confirm you wish to install the library and simulator. Type 'Y' or 'y' to accept.
        <br/> The script will then install a new Visual Studio project template that is configured to find the DAQlib library and simulator programs. 
        If successful, it should give an output similar to the following:

        <img class="figure" style="width:80%; margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="successful installation" src="https://apsc160.github.io/daqinstall/images/windows/success.png" /> 
        
        If you encounter an error that you cannot resolve, please either post a message on the discussion board with the output of the install script,
        or see a TA or instructor to help you complete the installation.
      </li>
    </ol>

    <h3>Installation for All Users:</h3>
    <p>
      The previous instructions will install the DAQlib library and simulator only for the current user. To install globally, for all users on a particular machine, 
      follow the same instructions but run the <span class="file" style="color: blue; font-weight: bold; font-family: courier;">install.bat</span> file as Administrator. This can be done by right-clicking on the file and selecting 
      "<span class="highlight" style="color: crimson; font-weight: bold;">Run as administrator</span>".
    </p>

    <h3>Manual Installation:</h3>

    <p>
      Due to some machine-specific configurations, the above installation script may fail.
      If this happens to you, you can still install the simulator and library manually
      using the following steps.
    </p>
    <ol>
      <li>Extract the the downloaded zip file and copy the contained <span class="highlight" style="color: crimson; font-weight: bold;">DAQlib</span> folder.</li>
      <li>In Windows Explorer, type <code>%APPDATA%</code> in the address bar and hit enter.
        This should bring you a path like <span class="highlight" style="color: crimson; font-weight: bold;">C:\Users\yourusername\AppData\Roaming</span></li>
      <li>Create a new folder here called <span class="highlight" style="color: crimson; font-weight: bold;">APSC160</span>, and paste the
          copied <span class="highlight" style="color: crimson; font-weight: bold;">DAQlib</span> folder inside</li>
      <li>Inside the <span class="highlight" style="color: crimson; font-weight: bold;">DAQlib</span> folder, go inside <span class="highlight" style="color: crimson; font-weight: bold;">VS</span>
          and copy the <span>DAQTemplate</span> folder</li>
      <li>Go to your user's <span class="highlight" style="color: crimson; font-weight: bold;">Documents</span> folder, which on most systems is
          <span class="highlight" style="color: crimson; font-weight: bold;">C:\Users\yourusername\Documents</span>, though you should see a link
          in the left Quick-Access panel.</li>
      <li>Within the <span class="highlight" style="color: crimson; font-weight: bold;">Documents</span> folder, navigate to
        <span class="highlight" style="color: crimson; font-weight: bold;">Visual Studio 2017\Templates\ProjectTemplates\Visual C++ Project</span></li>
      <li>Create a new folder here called <span class="highlight" style="color: crimson; font-weight: bold;">APSC160</span></li>
      <li>Inside <span class="highlight" style="color: crimson; font-weight: bold;">APSC160</span>, create a new folder <span class="highlight" style="color: crimson; font-weight: bold;">DAQlib</span>,
        and paste the <span class="highlight" style="color: crimson; font-weight: bold;">DAQTemplate</span> folder inside</li>
      <li>Restart Visual Studio</li>
    </ol>

    <h3>Uninstalling the Library:</h3>
    <p>
      To uninstall the DAQlib library, simply run the <span class="file" style="color: blue; font-weight: bold; font-family: courier;">uninstall.bat</span> script. If run as Administrator, the script will attempt to uninstall a global installation.
    </p>
  </div>
  <div class="tabpage" id="tabpage_2">
    <h3>A Simple DAQ Program</h3>
    <p>
      To get started, we will create a simple program that uses the DAQ simulator.
    </p>
    <p>
      Start the Visual Studio IDE by double clicking its icon on the desktop. You may see a dialog that prompts you to <em>Start with a familiar environment</em>, in which case select <em>Visual C++</em> for the <strong>Development Settings</strong>                  and then click the <strong>Start Visual Studio</strong> button.
    </p>

    We will begin by creating a project as follows:
    <ul>
      <li>Select the <strong>File</strong> menu, then <strong>New</strong>, then <strong>Project</strong>.</li>
      <li>When the <strong>New Project</strong> dialog box opens, select <strong>Installed</strong>, <strong>Templates</strong>, <strong>Visual C++</strong> and then <strong>APSC160</strong> in the left panel, and then select <strong>APSC160 - DAQ</strong>                    in the right panel.</li>
      <li>Enter a descriptive name for your project, e.g. <strong>DAQSimulatorTest</strong></li>
      <li>Select an appropriate location to save your project using the <strong>Browse</strong> button.</li>
      <li>The <strong>New Project</strong> dialog should now look like this:
        <img class="figure" style="margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="VS Project" src="https://apsc160.github.io/daqinstall/images/windows/DAQProject.png" />
      </li>
      <li>Click <strong>OK</strong>.</li>
    </ul>
    A new project will be displayed, which should look something like the following:
    <img class="figure" style="margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="Solution Explorer" src="https://apsc160.github.io/daqinstall/images/windows/DAQInitialProject.png" /> A new source file called <span class="code">main.c</span> will automatically be generated for you
    under <strong>Source Files</strong>. You can change the name of this file to something
    more descriptive by doing the following:
    <ul>
      <li>Right-click on the <span class="code">main.c</span></li>
      <li>Select <strong>Rename</strong> from the drop-down menu</li>
      <li>Enter a descriptive name for the new source file (e.g. <span class="code">DAQSimulatorTest.c</span>).</li>
    </ul>
    <br/> Now add code to the source file so that it looks like the following. Include your own name, student number, <em>et cetera</em> 
    at the top of the code.
    <img class="figure" style="width:80%; margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="console" src="https://apsc160.github.io/daqinstall/images/windows/DAQSimulatorTestSource.png" />
    <a href="https://apsc160.github.io/daqinstall/src/DAQSimulatorTest.c">DAQSimulatorTest.c</a>

    <p>
      We do not expect you to understand the code that you are typing yet (that will come in the next few weeks).
    </p>
    <p>
      To compile and link the source files in your project, choose
      <strong>Build Solution</strong> from the <strong>Build</strong> menu or press <strong>F7</strong>. This will compile all of the source files in your project (in this case there is only one) and then link them with the DAQlib library
      to produce an executable file.
    </p>
    <p>
      Run the program. If everything was installed successfully, a window like this one will appear:
      <img class="figure" style="width:80%; margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="console" src="https://apsc160.github.io/daqinstall/images/windows/DAQSimulatorTestConsole.png" />

      A second or two later, the simulator window should appear:

      <img class="figure" style="margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="Simulator with LED off" src="https://apsc160.github.io/daqinstall/images/windows/DAQSimulatorOff.png" />
      
      Click the "<strong>on</strong>" button for the switch labelled
      <strong>ToggleSwitch #0</strong>. The left-most LED should turn green:
      <img class="figure" style="margin-top: 1em; margin-bottom: 1em; display: block; margin-left: auto; margin-right: auto;" alt="Simulator with LED off" src="https://apsc160.github.io/daqinstall/images/windows/DAQSimulatorOn.png" /> 
      
      Congratulations! You have just completed your first DAQ program.
    </p>
    <p>
      <strong class="highlight" style="color: crimson; font-weight: bold;">Important:</strong> do not simply open the above source file by double-clicking on it in
        your downloads folder.  The source file <em>must</em> be added to your project in Visual Studio,
        and the project <em>must</em> have been created using the <strong></strong>APSC160 - DAQ</strong>
        template.  Otherwise, the file will not be compiled, and the project will not be able to find the
        required DAQlib library.
    </p>

    <h3>Running DAQ Programs Outside Visual Studio</h3>

    When you compile your programs with the DAQlib library, they now
    depend on certain files	contained in the DAQlib installation folder:
    <ul>
      <li><strong>DAQlib.dll</strong> - dynamic library file containing
        system-dependent routines</li>
      <li><strong>daqHardwareClient.exe</strong> - main client
        program that communicates with the DAQ hardware</li>
      <li><strong>daqSimulator.exe</strong> - the DAQ simulator program</li>
      <li>... and several other DLLs and configuration files found in the 
        <strong>bin32</strong> or <strong>bin64</strong> subfolder</li>
    </ul>
    <p>
      When running in Visual Studio, the project settings tell your
      computer where to find these files.  However, if you try to run
      your program outside of Visual Studio (i.e. by finding the folder
      the compiled binaries are placed and double-clicking the executable),
      you will get an error about not finding the above	dynamic library.
    </p>

    <p>
      To resolve this, you need to tell Windows where to look for the
      required files.  Windows searches for executables and libraries in
      directories contained in the system's
      <strong>PATH</strong> environment variable.  You will need
      to add two paths to this variable:
    </p>
    <ul>
      <li>%APPDATA%\APSC160\DAQlib\bin64</li>
      <li>%APPDATA%\APSC160\DAQlib\bin32</li>
    </ul>
    The first applies when compiling Windows binaries for 64-bit
    targets, while the second applies when compiling for 32-bit targets.
    For instructions on adding to the system <strong>PATH</strong>,
    see <a href="https://www.computerhope.com/issues/ch000549.htm">How
      to set the path and environment variables in Windows</a>.
  </div>
</div>
